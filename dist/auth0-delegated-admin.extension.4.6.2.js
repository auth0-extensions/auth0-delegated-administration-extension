"use strict";var __webpack_modules__=[(e,t,r)=>{const s=r(1),a=r(2).default,_=r(17),n=r(22),i=s.createServer(((e,t)=>(n.log("info","Starting Delegated Admin Extension - Version: 4.6.2"),a(e,t))));e.exports=(e,t,r)=>{t.x_wt&&t.x_wt.ectx&&t.x_wt.ectx.PUBLIC_WT_URL||!1||_.setValue("PUBLIC_WT_URL",s.urlHelpers.getWebtaskUrl(t)),i(e,t,r)}},e=>{e.exports=require("auth0-extension-express-tools@2.1.0")},(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var s=r(3),a=r.n(s),_=r(4),n=r.n(_),i=r(5),o=r.n(i),d=r(6),u=r.n(d),l=r(7),c=r.n(l),E=r(8),p=r(1),h=r(9),m=r(43),O=r(44),f=r(46),A=r(17),g=r.n(A),M=r(22),P=r.n(M),D=r(12);function T(e,t){g().setProvider(e);const r=t?new E.WebtaskStorageContext(t,{force:1}):new E.FileStorageContext(a().join(__dirname,"./data.json"),{mergeWrites:!0}),s=new(o());s.use(((e,t,r)=>{e.webtaskContext&&g().setProvider(E.configProvider.fromWebtaskContext(e.webtaskContext)),r()})),s.use(n()(":method :url :status :response-time ms - :res[content-length]",{stream:P().stream})),s.use(u().json()),s.use(u().urlencoded({extended:!1})),s.use(p.routes.dashboardAdmins({secret:g()("EXTENSION_SECRET"),audience:"urn:delegated-admin",rta:g()("AUTH0_RTA").replace("https://",""),domain:g()("AUTH0_DOMAIN"),baseUrl:g()("PUBLIC_WT_URL"),webtaskUrl:g()("PUBLIC_WT_URL"),clientName:"Delegated Administration",noAccessToken:!0,urlPrefix:"/admins",sessionStorageKey:"delegated-admin:apiToken",scopes:"read:clients delete:clients read:connections read:connections_options read:users update:users delete:users create:users read:logs read:device_credentials update:device_credentials delete:device_credentials delete:guardian_enrollments"})),s.use("/api",(0,h.default)(r)),s.use("/app",o().static(a().join(__dirname,"../dist"))),s.use("/meta",(0,O.default)()),s.use("/.extensions",(0,m.default)()),s.get("*",c()(),(0,f.default)());return s.use((0,D.errorHandler)((e=>P().log("error",e)))),s}},e=>{e.exports=require("path")},e=>{e.exports=require("morgan@1.10.0")},e=>{e.exports=require("express@4.18.2")},e=>{e.exports=require("body-parser@1.20.2")},e=>{e.exports=require("cookie-parser@1.4.6")},e=>{e.exports=require("auth0-extension-tools@1.5.2")},(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var s=r(5),a=r(10),_=r.n(a),n=r(11),i=r.n(n),o=r(1),d=r(8),u=r.n(d),l=r(12),c=r(17),E=r.n(c),p=r(18),h=r(26),m=r(27),O=r(28),f=r(30),A=r(31),g=r(32),M=r(33),P=r(34);const D=e=>{const t=new p.default(e),r=async function(e,t,r){try{const t={domain:E()("AUTH0_DOMAIN"),clientId:E()("AUTH0_CLIENT_ID"),clientSecret:E()("AUTH0_CLIENT_SECRET")},s=e.user&&e.user.access_token&&e.user.access_token.length?{domain:t.domain,accessToken:e.user.access_token,headers:t.headers}:t;return e.auth0=await u().managementApi.getClient(s),r(),null}catch(e){r(e)}},a=(0,s.Router)(),n=e=>_().get(e,"headers.authorization","").split(" ")[1],d=(e,t)=>{if(global.daeUser=global.daeUser||{},global.daeUser[t.sub]=global.daeUser[t.sub]||{exp:0,token:""},_().isFunction(global.daeUser[t.sub].then))return global.daeUser[t.sub];if(global.daeUser[t.sub].exp>i()().unix()&&e&&global.daeUser[t.sub].token===e)return _().assign(t,global.daeUser[t.sub]),Promise.resolve(t);e||console.error("no token found");const r=u().managementApi.getClient({domain:E()("AUTH0_DOMAIN"),clientId:E()("AUTH0_CLIENT_ID"),clientSecret:E()("AUTH0_CLIENT_SECRET")}).then((r=>r.users.get({id:t.sub}).then((r=>(_().assign(t,r),t.token=e,global.daeUser[t.sub]=t,t)))));return global.daeUser[t.sub]=r,global.daeUser[t.sub]};return a.use(o.middlewares.authenticateUsers.optional({domain:E()("AUTH0_CUSTOM_DOMAIN")||E()("AUTH0_DOMAIN"),audience:E()("EXTENSION_CLIENT_ID"),credentialsRequired:!1,onLoginSuccess:(e,t,r)=>{const s=e;return d(n(e),e.user).then((t=>(s.user=t,s.user.scope=(0,h.default)(e.user),r()))).catch(r)}})),a.use(o.middlewares.authenticateAdmins.optional({credentialsRequired:!1,secret:E()("EXTENSION_SECRET"),audience:"urn:delegated-admin",baseUrl:E()("PUBLIC_WT_URL"),onLoginSuccess:(e,t,r)=>{const s=e;return d(n(e),e.user).then((e=>(s.user=e,s.user.scope=[m.AUDITOR_PERMISSION,m.USER_PERMISSION,m.OPERATOR_PERMISSION,m.ADMIN_PERMISSION],r()))).catch(r)}})),a.use(((e,t,r)=>{t.setHeader("Cache-control","no-cache, no-store"),t.setHeader("Pragma","no-cache"),t.setHeader("Expires","0"),r()})),a.use(((e,t,r)=>{const s="get"===e.method.toLowerCase()?m.AUDITOR_PERMISSION:m.USER_PERMISSION;return(0,l.requireScope)(s)(e,t,r)})),a.use("/applications",r,(0,O.default)()),a.use("/connections",r,(0,f.default)(t)),a.use("/scripts",(0,l.requireScope)(m.ADMIN_PERMISSION),(0,A.default)(e,t)),a.use("/users",r,(0,P.default)(e,t)),a.use("/logs",r,(0,M.default)(t)),a.use("/me",(0,g.default)(t)),a.get("/settings",((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((e=>r.json({settings:e||{}}))).catch(s)})),a}},e=>{e.exports=require("lodash@4.17.21")},e=>{e.exports=require("moment@2.29.4")},(e,t,r)=>{r.r(t),r.d(t,{errorHandler:()=>_.default,requireScope:()=>a.default,verifyUserAccess:()=>s.default});var s=r(13),a=r(15),_=r(16)},(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var s=r(14),a=r.n(s),_=r(8);const n=(e,t)=>(r,s,n)=>r.auth0.users.get({id:r.params.id}).then((s=>{if(!s)return a().reject(new _.NotFoundError(`User not found: ${r.params.id}`));const n={request:{user:r.user},payload:{user:s,action:e}};return t.execute("access",n).then((()=>{r.targetUser=s}))})).then((()=>n())).catch(n)},e=>{e.exports=require("bluebird@3.7.2")},(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var s=r(8);const a=e=>(t,r,a)=>!t.user||!t.user.scope||t.user.scope.indexOf(e)<0?a(new s.ForbiddenError(`Cannot perform action. Missing scope ${e}`)):a()},(e,t,r)=>{r.r(t),r.d(t,{default:()=>s});const s=e=>(t,r,s,a)=>(e&&e(t),t&&(t.status||t.statusCode)?(s.status(t.status||t.statusCode),s.json({error:t.code||t.name,message:t.message||t.name})):(s.status(500),s.json({error:"InternalServerError",message:t.message||t.name})))},(e,t,r)=>{const s=r(8).config(),a=function(e){return"AUTH0_CUSTOM_DOMAIN"===e?s("AUTH0_CUSTOM_DOMAIN")||s("AUTH0_DOMAIN"):"IS_APPLIANCE"===e?s("AUTH0_RTA")&&"auth0.auth0.com"!==s("AUTH0_RTA").replace("https://",""):s(e)};a.getValue=function(e){return s(e)},a.setValue=function(e,t){return s.setValue(e,t)},a.setProvider=function(e){return s.setProvider(e)},e.exports=a},(e,t,r)=>{r.r(t),r.d(t,{default:()=>E});var s=r(14),a=r.n(s),_=r(19),n=r.n(_),i=r(21),o=r.n(i),d=r(8),u=r(22),l=r.n(u),c=r(24);class E{constructor(e,t=1e4){if(null==e)throw new d.ArgumentError("Must provide a storage object.");this.log=l().debug.bind(l()),this.cache={},this.storage=e,this.getCached=a().promisify(o()({load:(e,t)=>{this.get(e).then((e=>(t(null,e),null))).catch(t)},hash:e=>e,max:100,maxAge:t}))}get(e){return this.storage.read().then((t=>t&&t.scripts?t.scripts[e]:null))}save(e,t){return this.storage.read().then((r=>(r.scripts||(r.scripts={}),r.scripts[e]=t,r))).then((e=>this.storage.write(e)))}readCustomData(){return this.storage.read().then((e=>e.customData||{}))}writeCustomData(e){return this.storage.read().then((t=>(t.customData=e,t))).then((e=>this.storage.write(e)))}createContext(e){return{log:this.log,global:this.cache,read:this.readCustomData.bind(this),write:this.writeCustomData.bind(this),...e}}dynamicRequire(e){try{return require(e)}catch(e){}return r(25)(e)}execute(e,t){return this.getCached(e).then((r=>r?(l().debug(`Executing Delegated Admin hook: ${e}`),new(a())(((s,a)=>{try{n()(r,{require:this.dynamicRequire})(this.createContext(t),((t,r)=>{t?(l().error(`Failed to execute Delegated Admin hook (${e}): "${t}"`),a((0,c.default)(t,e))):s(r)}))}catch(t){l().error(`Failed to compile Delegated Admin hook (${e}): "${t}"`),a((0,c.default)(t,e))}}))):null))}}},(e,t,r)=>{var s=r(20);e.exports=function(e,t,r){var a={},_="SAFE_EVAL_"+Math.floor(1e6*Math.random());a[_]={};return e="\n    (function(){\n      Function = undefined;\n      const keys = Object.getOwnPropertyNames(this).concat(['constructor']);\n      keys.forEach((key) => {\n        const item = this[key];\n        if(!item || typeof item.constructor !== 'function') return;\n        this[key].constructor = undefined;\n      });\n    })();\n  "+_+"="+e,t&&Object.keys(t).forEach((function(e){a[e]=t[e]})),s.runInNewContext(e,a,r),a[_]}},e=>{e.exports=require("vm")},e=>{e.exports=require("lru-memoizer@1.10.0")},(e,t,r)=>{const s=r(23),a=s.createLogger({levels:s.config.syslog.levels,transports:[new s.transports.Console({level:"debug",handleExceptions:!0,format:s.format.combine(s.format.timestamp(),s.format.printf((e=>`${e.timestamp} - ${e.level}: ${e.message}`)))})],exitOnError:!1});e.exports=a,e.exports.stream={write:e=>{a.log("info",e.replace(/\n$/,""))}}},e=>{e.exports=require("winston@3.10.0")},(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var s=r(8);const a=(e,t)=>{const r=new s.ValidationError(e.message||"");let a=`${t}-script error`;return e.stack&&(a=e.stack.replace(/SAFE_EVAL_\d+/,`${t}-script error`).replace("evalmachine.<anonymous>","line")),r.stack=a.split("\n").slice(0,2).join(" "),r}},e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=25,e.exports=t},(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var s=r(10),a=r.n(s),_=r(27);const n=(e,t)=>{const r=a().find(e,((e,t)=>a().startsWith(t,"https:")&&a().endsWith(t,"auth0-delegated-admin"))),s=[e[t],e.app_metadata&&e.app_metadata[t],e.app_metadata&&e.app_metadata.authorization&&e.app_metadata.authorization[t],r&&r[t]];return a()(s).flatten().compact().uniq().value()},i=e=>{let t=-1;if(!e)return t;const r=Array.isArray(e)?e:e.replace(", ",",","g").split(",");return r.indexOf(_.AUDITOR_ROLE_NAME)>=0&&(t=_.AUDITOR_ACCESS_LEVEL),r.indexOf(_.USER_ROLE_NAME)>=0&&(t=_.USER_ACCESS_LEVEL),r.indexOf(_.OPERATOR_ROLE_NAME)>=0&&(t=_.OPERATOR_ACCESS_LEVEL),r.indexOf(_.ADMIN_ROLE_NAME)>=0&&(t=_.ADMIN_ACCESS_LEVEL),t};function o(e){const t=n(e,"roles"),r=n(e,"permissions"),s=i(t);return s>=_.AUDITOR_ACCESS_LEVEL&&r.indexOf(_.AUDITOR_PERMISSION)<0&&r.push(_.AUDITOR_PERMISSION),s>=_.USER_ACCESS_LEVEL&&r.indexOf(_.USER_PERMISSION)<0&&r.push(_.USER_PERMISSION),s>=_.OPERATOR_ACCESS_LEVEL&&r.indexOf(_.OPERATOR_PERMISSION)<0&&r.push(_.OPERATOR_PERMISSION),s===_.ADMIN_ACCESS_LEVEL&&r.indexOf(_.ADMIN_PERMISSION)<0&&r.push(_.ADMIN_PERMISSION),r}},(e,t,r)=>{r.r(t),r.d(t,{ADMIN_ACCESS_LEVEL:()=>n,ADMIN_PERMISSION:()=>p,ADMIN_ROLE_NAME:()=>u,AUDITOR_ACCESS_LEVEL:()=>s,AUDITOR_PERMISSION:()=>l,AUDITOR_ROLE_NAME:()=>i,OPERATOR_ACCESS_LEVEL:()=>_,OPERATOR_PERMISSION:()=>E,OPERATOR_ROLE_NAME:()=>d,USER_ACCESS_LEVEL:()=>a,USER_PERMISSION:()=>c,USER_ROLE_NAME:()=>o,VALID_SCRIPTS:()=>h});const s=0,a=1,_=2,n=3,i="Delegated Admin - Auditor",o="Delegated Admin - User",d="Delegated Admin - Operator",u="Delegated Admin - Administrator",l="read:users",c="manage:users",E="read:logs",p="manage:config",h=["access","filter","create","memberships","settings"]},(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var s=r(10),a=r.n(s),_=r(5),n=r(29);const i=()=>{const e=(0,_.Router)();return e.get("/",((e,t,r)=>{(0,n.default)(e.auth0,"clients",{is_global:!1,fields:"client_id,name,app_type"}).then((e=>a().chain(e).filter((e=>"spa"===e.app_type||"native"===e.app_type||"regular_web"===e.app_type)).map((({client_id:e,name:t})=>({client_id:e,name:t}))).sortBy((e=>e.name.toLowerCase())).value())).then((e=>t.json(e))).catch(r)})),e}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var s=r(14),a=r.n(s),_=r(8);function n(e,t,r={},s={}){const n=s.perPage||50,i=s.concurrency||5,o=s.limit||null;if(null==e)throw new _.ArgumentError("Must provide a auth0 client object.");if(!t&&!e[t])throw new _.ArgumentError("Must provide a valid entity for auth0 client.");const d={...r,per_page:n},u=[];let l=0,c=0;const E=r=>e[t].getAll({...d,page:r}).then((e=>(e.forEach((e=>u.push(e))),null)));return e[t].getAll({...d,include_totals:!0,page:0}).then((e=>(l=e.total||0,c=Math.ceil(l/n),o&&l>o?(c=1,null):((e[t]||e||[]).forEach((e=>u.push(e))),null)))).then((()=>{if(o&&l>o)return u;if(0===l||u.length>=l)return u;const e=[];for(let t=1;t<=c;t++)e.push(t);return a().map(e,E,{concurrency:i})})).then((()=>u))}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var s=r(10),a=r.n(s),_=r(5),n=r(29);const i=e=>{const t=(0,_.Router)();return t.get("/",((t,r,s)=>{(0,n.default)(t.auth0,"connections",{strategy:"auth0",fields:"id,name,strategy,options"},{limit:2e4,perPage:100}).then((r=>{global.connections=r.map((e=>({name:e.name,id:e.id})));const s={request:{user:t.user},locale:t.headers["dae-locale"]};return e.execute("settings",s).then((e=>{let t=a().chain(r).sortBy((e=>e.name.toLowerCase())).value();return e&&e.connections&&Array.isArray(e.connections)&&e.connections.length&&(t=t.filter((t=>e.connections.indexOf(t.name)>=0))),t}))})).then((e=>e.map((e=>({id:e.id,name:e.name,strategy:e.strategy,options:e.options?{requires_username:e.options.requires_username}:null}))))).then((e=>r.json(e))).catch(s)})),t}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var s=r(5),a=r(8),_=r(27);const n=(e,t)=>{const r=(0,s.Router)();return r.get("/:name",((e,r,s)=>_.VALID_SCRIPTS.indexOf(e.params.name)<0?s(new a.ValidationError(`Invalid script name: ${e.params.name}`)):t.get(e.params.name).then((e=>r.json({script:e}))).catch(s))),r.post("/:name",((e,r,s)=>_.VALID_SCRIPTS.indexOf(e.params.name)<0?s(new a.ValidationError(`Invalid script name: ${e.params.name}`)):t.save(e.params.name,e.body.script).then((()=>r.status(200).send())).catch(s))),r}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var s=r(5),a=r.n(s),_=r(22),n=r.n(_),i=r(27);const o=e=>{const t=a().Router();return t.get("/",((t,r)=>{let s=0;t.user.scope.indexOf(i.ADMIN_PERMISSION)>=0?s=3:t.user.scope.indexOf(i.OPERATOR_PERMISSION)>=0?s=2:t.user.scope.indexOf(i.USER_PERMISSION)>=0&&(s=1);const a={createMemberships:!1,memberships:[],role:s},_={request:{user:t.user},payload:{user:t.user}};e.execute("memberships",_).then((e=>(e&&Array.isArray(e)?a.memberships=e:e&&(a.createMemberships=e.createMemberships||!1,a.memberships=e.memberships||[]),r.json(a)))).catch((e=>{n().error(e.message),r.json(a)}))})),t}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var s=r(14),a=r.n(s),_=r(5),n=r(8),i=r(12),o=r(27);const d=e=>{const t=(0,_.Router)();return t.get("/",(0,i.requireScope)(o.OPERATOR_PERMISSION),((e,t,r)=>{e.auth0.logs.getAll({q:"NOT type: sapi AND NOT type:fapi",sort:"date:-1",per_page:20,page:e.query.page||0,fields:"type,date,client_name,user_name,description,connection"}).then((e=>t.json(e))).catch(r)})),t.get("/:id",((t,r,s)=>{t.auth0.logs.get({id:t.params.id}).then((r=>!r||"fapi"!==r.type&&"sapi"!==r.type?t.user.scope.indexOf(o.OPERATOR_PERMISSION)>=0?r:t.auth0.users.get({id:r.user_id}).then((s=>{if(!s)throw new n.NotFoundError(`User not found: ${t.params.id}`);const a={request:{user:t.user},payload:{user:s}};return e.execute("access",a).then((()=>r))})):a().reject(new Error("Invalid log record.")))).then((e=>r.json({log:e}))).catch(s)})),t}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__),auth0__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(35),auth0__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(auth0__WEBPACK_IMPORTED_MODULE_1__),request__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(36),request__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(request__WEBPACK_IMPORTED_MODULE_2__),bluebird__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(14),bluebird__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(bluebird__WEBPACK_IMPORTED_MODULE_3__),express__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5),express__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_4__),auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8),auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__),_lib_config__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(17),_lib_config__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_lib_config__WEBPACK_IMPORTED_MODULE_6__),_lib_logger__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(22),_lib_logger__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_lib_logger__WEBPACK_IMPORTED_MODULE_7__),_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(12),_lib_removeGuardian__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(37),_lib_userBlocks__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(39),_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(40),_lib_getConnectionIdByName__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(41),_lib_getConnection__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(42);const isValidField=(e,t,r)=>t&&lodash__WEBPACK_IMPORTED_MODULE_0___default().includes(t,r.property)||!t&&!1!==r[e],checkCustomFieldValidation=(req,context,isEditRequest,onlyTheseFields)=>{if(!context.userFields)return context.payload;const requiredErrorText=req.query&&req.query.requiredErrorText||"required",type=isEditRequest?"edit":"create",ignoredFields=lodash__WEBPACK_IMPORTED_MODULE_0___default().map(lodash__WEBPACK_IMPORTED_MODULE_0___default().filter(context.userFields,(e=>!isValidField(type,onlyTheseFields,e))),"property"),fieldsToValidate=lodash__WEBPACK_IMPORTED_MODULE_0___default().filter(context.userFields,(e=>!lodash__WEBPACK_IMPORTED_MODULE_0___default().includes(ignoredFields,e.property)&&lodash__WEBPACK_IMPORTED_MODULE_0___default().isObject(e[type])&&(e[type].required||e[type].validationFunction))),errorList={};if(fieldsToValidate.forEach((field=>{const value=lodash__WEBPACK_IMPORTED_MODULE_0___default().get(context.payload,field.property),errorKey=field.label||field.property;if(value&&0!==value.length){if(field[type].validationFunction)try{const validationFunction=eval(`(${field[type].validationFunction})`);if(lodash__WEBPACK_IMPORTED_MODULE_0___default().isFunction(validationFunction)){const e=validationFunction(value,context.payload);if(e)return void(errorList[errorKey]=e)}else _lib_logger__WEBPACK_IMPORTED_MODULE_7___default().warn(`warning: skipping invalid validation function: ${field[type].validationFunction}, because: it is not a function`)}catch(e){_lib_logger__WEBPACK_IMPORTED_MODULE_7___default().warn(`warning: skipping invalid validation function: ${field[type].validationFunction}, because: `,e.message)}if(field[type].options){const e=lodash__WEBPACK_IMPORTED_MODULE_0___default().isObject(value)?value.value:value,t=lodash__WEBPACK_IMPORTED_MODULE_0___default().map(field[type].options,(e=>lodash__WEBPACK_IMPORTED_MODULE_0___default().isObject(e)?e.value:e));if(t.indexOf(e)<0)return void(errorList[errorKey]=`${e} is not an allowed option`)}}else field[type].required&&(errorList[errorKey]=[requiredErrorText||"required"])})),Object.keys(errorList).length>0)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError(lodash__WEBPACK_IMPORTED_MODULE_0___default().map(errorList,((e,t)=>`${t}: ${e}`)).join("\n"));if(onlyTheseFields){const e=lodash__WEBPACK_IMPORTED_MODULE_0___default().cloneDeep(context.payload);context.payload={},onlyTheseFields.forEach((t=>{lodash__WEBPACK_IMPORTED_MODULE_0___default().set(context.payload,t,lodash__WEBPACK_IMPORTED_MODULE_0___default().get(e,t))}))}return lodash__WEBPACK_IMPORTED_MODULE_0___default().omit(context.payload,ignoredFields)},executeWriteHook=(e,t,r,s)=>{const a=e.targetUser,_={method:"update",request:{user:e.user,originalUser:a},payload:e.body,userFields:r};try{_.payload=checkCustomFieldValidation(e,_,!0,s)}catch(e){return bluebird__WEBPACK_IMPORTED_MODULE_3___default().reject(e)}return t.execute("create",_)},resolveUserIdentifier=async(e,t,r)=>{try{const s=await(0,_lib_getConnection__WEBPACK_IMPORTED_MODULE_13__.default)(e,r);if(!s)return _lib_logger__WEBPACK_IMPORTED_MODULE_7___default().debug("No connection found. Using email as a fallback."),t.email;const a=Object.entries(s.options.attributes).filter((([e,t])=>!0===t.identifier?.active)).map((([e])=>e)).find((e=>null!=t[e]));return a&&t[a]?t[a]:(_lib_logger__WEBPACK_IMPORTED_MODULE_7___default().debug(`No active identifier value found for the active ${a}. Using email as a fallback.`),t.email)}catch(e){return _lib_logger__WEBPACK_IMPORTED_MODULE_7___default().debug("Failed to resolve active identifier, using email as fallback:",e.message),t.email}},__WEBPACK_DEFAULT_EXPORT__=(e,t)=>{const r=(0,express__WEBPACK_IMPORTED_MODULE_4__.Router)();return r.post("/",((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((a=>{const _=(a=a||{}).userFields,n={method:"create",request:{user:e.user},payload:e.body,defaultPayload:{email:e.body.email,username:e.body.username,password:e.body.password,connection:e.body.connection,app_metadata:e.body.memberships&&e.body.memberships.length&&{memberships:e.body.memberships}||{}},userFields:_};if(!1===(void 0===a.canCreateUser||a.canCreateUser))return s(new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError("Create user is forbidden"));if(!lodash__WEBPACK_IMPORTED_MODULE_0___default().find(_,{property:"repeatPassword"})&&e.body.repeatPassword!==e.body.password)return s(new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The passwords do not match."));try{n.payload=checkCustomFieldValidation(e,n)}catch(e){return s(e)}return delete n.payload.repeatPassword,t.execute("create",n).then((e=>{if(!(e=e||n.defaultPayload).email||0===e.email.length)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The email address is required.");return e})).then((t=>e.auth0.users.create(t))).then((()=>r.status(201).send())).catch(s)}))})),r.get("/",((e,r,s)=>{const a={request:{user:e.user},payload:{search:e.query.search,filterBy:e.query.filterBy}},_=_lib_config__WEBPACK_IMPORTED_MODULE_6___default()("USER_SEARCH_ENGINE")||"v3",n="v2"===_?'"':"";let i=e.query.search;e.query.filterBy&&e.query.filterBy.length>0&&(i=`${e.query.filterBy}:${n}${e.query.search}${n}`);const o=e.query.sortProperty&&e.query.sortOrder?`${e.query.sortProperty}:${e.query.sortOrder}`:"last_login:-1";t.execute("filter",a).then((t=>{const r=t&&void 0!==t.query?t.query:t,s={sort:o,q:i&&r?`(${i}) AND ${r}`:i||r,per_page:e.query.per_page||10,page:e.query.page||0,include_totals:!0,fields:"user_id,username,name,email,identities,picture,last_login,logins_count,multifactor,blocked,app_metadata,user_metadata",search_engine:_};return e.auth0.users.getAll(s)})).then((r=>bluebird__WEBPACK_IMPORTED_MODULE_3___default().map(r.users,((s,a)=>t.execute("access",{request:{user:e.user},payload:{user:s,action:"read:user"}}).then((e=>{r.users[a]=e||s})))).then((()=>r)))).then((e=>r.json(e))).catch((e=>s(e)))})),r.get("/:id",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("read:user",t),((e,r,s)=>{const a=e.targetUser,_={request:{user:e.user},payload:{user:a}};return t.execute("memberships",_).then((e=>e&&Array.isArray(e)?{user:a,memberships:e}:e&&e.memberships?{user:a,memberships:e.memberships}:{user:a,memberships:[]})).then((t=>{if(!t.user.identities)return t.connection={},t;const r=t.user.identities.filter((e=>"auth0"===e.provider)),s=r[0]&&r[0].connection;return s?(t.user.connection=s,(0,_lib_getConnectionIdByName__WEBPACK_IMPORTED_MODULE_12__.default)(e.auth0,s).then((t=>t?e.auth0.connections.get({id:t,fields:"enabled_clients"}):{})).then((e=>(t.connection={enabled_clients:e.enabled_clients},t)))):(t.connection={},t)})).then((t=>(0,_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__.default)(e).then((r=>(0,_lib_userBlocks__WEBPACK_IMPORTED_MODULE_10__.requestUserBlocks)(r,e.params.id).then((e=>(e&&(t.user.blocked_for=e),r))))).then((s=>(0,_lib_removeGuardian__WEBPACK_IMPORTED_MODULE_9__.requestGuardianEnrollments)(s,e.params.id).then((e=>(!t.user.multifactor||e&&e.length?!t.user.multifactor&&e&&(t.user.multifactor=["guardian"]):(t.user.multifactor=t.user.multifactor.filter((e=>"guardian"!==e)),t.user.multifactor=t.user.multifactor.length?t.user.multifactor:null),r.json(t)))))))).catch((e=>{_lib_logger__WEBPACK_IMPORTED_MODULE_7___default().error("Failed to get user because: ",e),s(e)}))})),r.delete("/:id",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("delete:user",t),((e,t,r)=>e.user.sub===e.params.id?r(new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("You cannot delete yourself.")):e.auth0.users.delete({id:e.params.id}).then((()=>t.sendStatus(204))).catch(r))),r.patch("/:id",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("change:profile",t),((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((r=>{const s=["username","email","password","repeatPassword","connection"],a=lodash__WEBPACK_IMPORTED_MODULE_0___default().map(lodash__WEBPACK_IMPORTED_MODULE_0___default().filter(r.userFields,(e=>e.edit&&!lodash__WEBPACK_IMPORTED_MODULE_0___default().includes(s,e.property))),"property");return executeWriteHook(e,t,r.userFields,a)})).then((t=>e.auth0.users.update({id:e.params.id},t))).then((()=>r.status(204).send())).catch(s)})),r.post("/:id/password-reset",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("reset:password",t),(async(e,t,r)=>{const s=new(auth0__WEBPACK_IMPORTED_MODULE_1___default().AuthenticationClient)({domain:_lib_config__WEBPACK_IMPORTED_MODULE_6___default()("AUTH0_DOMAIN"),clientId:_lib_config__WEBPACK_IMPORTED_MODULE_6___default()("AUTH0_CLIENT_ID")}),a=e.targetUser,_=e.body.connection,n={email:await resolveUserIdentifier(e.auth0,a,_),connection:_,client_id:e.body.clientId};return s.requestChangePasswordEmail(n).then((()=>t.sendStatus(204))).catch((e=>{r(e)}))})),r.put("/:id/change-password",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("change:password",t),((e,r,s)=>{if(e.body.password!==e.body.repeatPassword)return s(new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ArgumentError("Passwords don't match"));const a={request:{user:e.user},locale:e.headers["dae-locale"]};return t.execute("settings",a).then((a=>a&&a.userFields?executeWriteHook(e,t,a.userFields,["password","repeatPassword"]).then((t=>{if(!t.password)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The password is required.");t=lodash__WEBPACK_IMPORTED_MODULE_0___default().pick(t,["password","connection","verify_password","app_metadata"]);const a=lodash__WEBPACK_IMPORTED_MODULE_0___default().defaults(t,{connection:e.body.connection,verify_password:!1});return e.auth0.users.update({id:e.params.id},a).then((()=>r.sendStatus(204))).catch(s)})):e.auth0.users.update({id:e.params.id},{password:e.body.password,connection:e.body.connection,verify_password:!1}).then((()=>r.sendStatus(204))).catch(s))).catch(s)})),r.put("/:id/change-username",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("change:username",t),((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((a=>{a&&a.userFields?executeWriteHook(e,t,a.userFields,["username"]).then((t=>{if(!t.username)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The username is required.");return e.auth0.users.update({id:e.params.id},t)})).then((()=>r.status(204).send())).catch(s):e.auth0.users.update({id:e.params.id},{username:e.body.username}).then((()=>r.sendStatus(204))).catch(s)})).catch(s)})),r.put("/:id/change-email",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("change:email",t),((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((a=>{a&&a.userFields?executeWriteHook(e,t,a.userFields,["email"]).then((t=>{if(!t.email)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The email is required.");return e.auth0.users.update({id:e.params.id},t)})).then((()=>r.status(204).send())).catch(s):e.auth0.users.update({id:e.params.id},{email:e.body.email}).then((()=>r.sendStatus(204))).catch(s)})).catch(s)})),r.get("/:id/devices",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("read:devices",t),((e,t,r)=>{e.auth0.deviceCredentials.getAll({user_id:e.params.id}).then((e=>t.json({devices:e}))).catch(r)})),r.get("/:id/logs",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("read:logs",t),((e,t,r)=>{(0,_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__.default)(e).then((s=>{const a={uri:`https://${_lib_config__WEBPACK_IMPORTED_MODULE_6___default()("AUTH0_DOMAIN")}/api/v2/users/${encodeURIComponent(e.params.id)}/logs`,headers:{authorization:`Bearer ${s}`},json:!0};return request__WEBPACK_IMPORTED_MODULE_2___default().get(a,((e,s,a)=>e?r(e):s.statusCode<200||s.statusCode>=300?(_lib_logger__WEBPACK_IMPORTED_MODULE_7___default().error("Log response failed: ",s.headers),r(new Error(a&&(a.error||a.message||a.code)||`Request Error: ${s.statusCode}`))):t.json(a)))})).catch(r)})),r.delete("/:id/multifactor/:provider",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("remove:multifactor-provider",t),((e,t,r)=>{const s=e.params.provider,a=e.params.id;"duo"===s||"google-authenticator"===s?e.auth0.users.deleteMultifactorProvider({id:a,provider:s}).then((()=>t.sendStatus(204))).catch(r):(0,_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__.default)(e).then((e=>(0,_lib_removeGuardian__WEBPACK_IMPORTED_MODULE_9__.removeGuardian)(e,a))).then((()=>t.sendStatus(204))).catch(r)})),r.put("/:id/block",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("block:user",t),((e,t,r)=>{e.auth0.users.update({id:e.params.id},{blocked:!0}).then((()=>t.sendStatus(204))).catch(r)})),r.put("/:id/unblock",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("unblock:user",t),((e,t,r)=>{e.auth0.users.update({id:e.params.id},{blocked:!1}).then((()=>t.sendStatus(204))).catch(r)})),r.delete("/:id/blocks",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("unblock:user",t),((e,t,r)=>{(0,_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__.default)(e).then((t=>(0,_lib_userBlocks__WEBPACK_IMPORTED_MODULE_10__.removeUserBlocks)(t,e.params.id))).then((()=>t.sendStatus(204))).catch(r)})),r.post("/:id/send-verification-email",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("send:verification-email",t),((e,t,r)=>{const s={user_id:e.params.id};e.auth0.jobs.verifyEmail(s).then((()=>t.status(204).send())).catch(r)})),r}},e=>{e.exports=require("auth0@3.5.0")},e=>{e.exports=require("request@2.88.2")},(e,t,r)=>{r.r(t),r.d(t,{removeGuardian:()=>u,requestGuardianEnrollments:()=>d});var s=r(14),a=r.n(s),_=r(38),n=r.n(_),i=r(17),o=r.n(i);const d=(e,t)=>new(a())(((r,s)=>{n().get(`https://${o()("AUTH0_DOMAIN")}/api/v2/users/${t}/enrollments`).set("Authorization",`Bearer ${e}`).set("Content-Type","application/json").end(((e,t)=>{if(e)return s(e);const a=t&&t.body&&t.body[0]?t.body[0].id:null;return r(a)}))})),u=(e,t)=>d(e,t).then((t=>((e,t)=>new(a())(((r,s)=>t?n().del(`https://${o()("AUTH0_DOMAIN")}/api/v2/guardian/enrollments/${t}`).set("Authorization",`Bearer ${e}`).set("Content-Type","application/json").end((e=>e?s(e):r())):r(null))))(e,t)))},e=>{e.exports=require("superagent@8.0.9")},(e,t,r)=>{r.r(t),r.d(t,{removeUserBlocks:()=>u,requestUserBlocks:()=>d});var s=r(14),a=r.n(s),_=r(38),n=r.n(_),i=r(17),o=r.n(i);const d=(e,t)=>new(a())(((r,s)=>{n().get(`https://${o()("AUTH0_DOMAIN")}/api/v2/user-blocks/${t}`).set("Authorization",`Bearer ${e}`).set("Content-Type","application/json").end(((e,t)=>{if(e)return s(e);const a=t&&t.body&&t.body.blocked_for?t.body.blocked_for:null;return r(a)}))})),u=(e,t)=>new(a())(((r,s)=>{n().del(`https://${o()("AUTH0_DOMAIN")}/api/v2/user-blocks/${t}`).set("Authorization",`Bearer ${e}`).set("Content-Type","application/json").end(((e,t)=>e?s(e):r(t)))}))},(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var s=r(14),a=r.n(s),_=r(8),n=r(17),i=r.n(n);const o=e=>e&&e.user&&e.user.access_token?new(a())((t=>t(e.user.access_token))):_.managementApi.getAccessTokenCached(i()("AUTH0_DOMAIN"),i()("AUTH0_CLIENT_ID"),i()("AUTH0_CLIENT_SECRET"))},(e,t,r)=>{r.r(t),r.d(t,{default:()=>_});var s=r(14),a=r.n(s);function _(e,t){const r=Array.isArray(global.connections)&&global.connections.filter((e=>e.name===t))[0];return r?a().resolve(r.id):e.connections.getAll({name:t,fields:"id"}).then((e=>e&&e[0]&&e[0].id))}},(e,t,r)=>{function s(e,t){return e.connections.getAll({name:t}).then((e=>e&&e[0]))}r.r(t),r.d(t,{default:()=>s})},(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var s=r(5),a=r(1),_=r(17),n=r.n(_),i=r(22),o=r.n(i);const d=()=>{const e=a.middlewares.validateHookToken(n()("AUTH0_DOMAIN"),n()("WT_URL"),n()("EXTENSION_SECRET")),t=(0,s.Router)();return t.use("/on-uninstall",e("/.extensions/on-uninstall")),t.use(a.middlewares.managementApiClient({domain:n()("AUTH0_DOMAIN"),clientId:n()("AUTH0_CLIENT_ID"),clientSecret:n()("AUTH0_CLIENT_SECRET")})),t.delete("/on-uninstall",((e,t)=>{o().debug("Uninstall running..."),e.auth0.clients.delete({client_id:n()("AUTH0_CLIENT_ID")}).then((()=>{o().debug(`Deleted client: ${n()("AUTH0_CLIENT_ID")}`),t.sendStatus(204)})).catch((e=>{o().debug(`Error deleting client: ${n()("AUTH0_CLIENT_ID")}`),o().error(e),t.sendStatus(204)}))})),t}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var s=r(5),a=r.n(s),_=r(45);const n=()=>{const e=a().Router();return e.get("/",((e,t)=>{t.status(200).send(_)})),e}},e=>{e.exports=JSON.parse('{"title":"Delegated Administration Dashboard","name":"auth0-delegated-admin","version":"4.6.0","author":"auth0","useHashName":false,"description":"This extension allows non-dashboard administrators to manage (a subset of) users.","type":"application","category":"end_user","logoUrl":"https://cdn.auth0.com/extensions/auth0-delegated-admin/assets/logo.svg","initialUrlPath":"/","docsUrl":"https://auth0.com/docs/extensions/delegated-admin","repository":"https://github.com/auth0-extensions/auth0-delegated-administration-extension","keywords":["auth0","extension"],"auth0":{"createClient":true,"onUninstallPath":"/.extensions/on-uninstall","scopes":"read:clients delete:clients read:connections read:connections_options read:users update:users delete:users create:users read:logs read:device_credentials update:device_credentials delete:device_credentials delete:guardian_enrollments"},"secrets":{"EXTENSION_CLIENT_ID":{"description":"Client ID of the application you created in the Auth0 Dashboard","required":true},"TITLE":{"description":"Custom title for the dashboard","example":"Fabrikam User Management","required":false},"CUSTOM_CSS":{"description":"A CSS file containing custom styles for the extension","example":"https://cdn.fabrikam.com/static/extensions/theme/fabrikam.css","required":false},"FAVICON_PATH":{"description":"Path to custom favicon","example":"https://cdn.fabrikam.com/static/extensions/theme/favicon.png","required":false},"AUTH0_CUSTOM_DOMAIN":{"description":"Custom domain","example":"example.com","required":false},"USER_SEARCH_ENGINE":{"description":"User search engine. Cloud only supports V3","type":"select","default":"v3","allowMultiple":false,"options":[{"value":"v3","text":"v3"},{"value":"v2","text":"v2"}]},"FEDERATED_LOGOUT":{"description":"Also sign out from the IDP when users logout?","type":"select","allowMultiple":false,"options":[{"value":"false","text":"No"},{"value":"true","text":"Yes"}]}}}')},(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var s=r(47),a=r.n(s),_=r(48),n=r.n(_),i=r(3),o=r.n(i),d=r(1),u=r(22),l=r.n(u),c=r(17),E=r.n(c);const p=()=>{const e='\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n      <title><%= config.TITLE %></title>\n      <meta charset="UTF-8" />\n      <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n      <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n      <link rel="shortcut icon" href="<%= assets.favIcon %>" />\n      <meta name="viewport" content="width=device-width, initial-scale=1">\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styles/zocial.min.css" />\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/manage/v0.3.1672/css/index.min.css" />\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styleguide/4.6.13/index.min.css" />\n      <% if (assets.style) { %><link rel="stylesheet" type="text/css" href="/app/<%= assets.style %>" /><% } %>\n      <% if (assets.version) { %><link rel="stylesheet" type="text/css" href="<%= assets.cdnPath %>/auth0-delegated-admin.ui.<%= assets.version %>.css" /><% } %>\n      <% if (assets.customCss) { %><link rel="stylesheet" type="text/css" href="<%= assets.customCss %>" /><% } %>\n    </head>\n    <body>\n      <div id="app"></div>\n      <script src="https://cdn.auth0.com/js/auth0/9.8.2/auth0.min.js"><\/script>\n      <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.1672/js/bundle.js"><\/script>\n      <script type="text/javascript">window.config = <%- JSON.stringify(config) %>;<\/script>\n      <% if (assets.vendors) { %><script type="text/javascript" src="/app/<%= assets.vendors %>"><\/script><% } %>\n      <% if (assets.app) { %><script type="text/javascript" src="/app/<%= assets.app %>"><\/script><% } %>\n      <% if (assets.version) { %>\n      <script type="text/javascript" src="<%= assets.cdnPath %>/auth0-delegated-admin.ui.vendors.<%= assets.version %>.js"><\/script>\n      <script type="text/javascript" src="<%= assets.cdnPath %>/auth0-delegated-admin.ui.<%= assets.version %>.js"><\/script>\n      <% } %>\n    </body>\n    </html>\n    ';return(t,r,s)=>{if(0===t.url.indexOf("/api"))return s();const _=(e=>{const t=d.urlHelpers.getBasePath(e);l().log("info",e.originalUrl);const r=new URL(`https://${e.headers.host}${e.originalUrl}`).pathname.replace(t,"").split("/");return["api","login","logs","configuration","users"].indexOf(r[0])<0&&""!==r[0]?r[0]:e.cookies["dae-locale"]||"en"})(t),i=d.urlHelpers.getBasePath(t);if(0!==t.url.indexOf("/login")&&(r.cookie("dae-locale",_),0!==t.url.indexOf(`/${_}`)))return r.redirect(`${i}${_}${t.url||"/login"}`);const u={AUTH0_DOMAIN:E()("AUTH0_DOMAIN"),AUTH0_CUSTOM_DOMAIN:E()("AUTH0_CUSTOM_DOMAIN"),IS_APPLIANCE:E()("IS_APPLIANCE"),AUTH0_CLIENT_ID:E()("EXTENSION_CLIENT_ID"),EXTEND_URL:E()("EXTEND_URL"),BASE_URL:d.urlHelpers.getBaseUrl(t),BASE_PATH:`${i}${_}/`,TITLE:E()("TITLE"),FEDERATED_LOGOUT:"true"===E()("FEDERATED_LOGOUT"),AUTH0_MANAGE_URL:E()("AUTH0_MANAGE_URL")||"https://manage.auth0.com",LOCALE:_},c="4.6.2",p={WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"4.6.2"}.PR_NUMBER;if(c){const t=E()("FAVICON_PATH")||"https://cdn.auth0.com/styleguide/4.6.13/lib/logos/img/favicon.png",s=E()("CDN_PATH")||(p?`//s3.amazonaws.com/extensions-review/auth0-delegated-admin-pr-${p}/assets`:"//cdn.auth0.com/extensions/auth0-delegated-admin/assets");return r.send(n().render(e,{config:u,assets:{customCss:E()("CUSTOM_CSS"),version:c,cdnPath:s,favIcon:t}}))}return a().readFile(o().join(__dirname,"../../dist/manifest.json"),"utf8",((t,s)=>{const a={config:u,assets:{customCss:E()("CUSTOM_CSS"),app:"bundle.js"}};!t&&s&&(a.assets={customCss:E()("CUSTOM_CSS"),...JSON.parse(s)}),r.send(n().render(e,a))}))}}},e=>{e.exports=require("fs")},e=>{e.exports=require("ejs@3.1.9")}],__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(0);module.exports=__webpack_exports__;