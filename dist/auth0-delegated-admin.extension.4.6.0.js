"use strict";var __webpack_modules__=[(e,t,r)=>{const s=r(1),a=r(2).default,n=r(13),i=r(19),_=s.createServer(((e,t)=>(i.log("info","Starting Delegated Admin Extension - Version: 4.6.0"),a(e,t))));e.exports=(e,t,r)=>{t.x_wt&&t.x_wt.ectx&&t.x_wt.ectx.PUBLIC_WT_URL||!1||n.setValue("PUBLIC_WT_URL",s.urlHelpers.getWebtaskUrl(t)),_(e,t,r)}},e=>{e.exports=require("auth0-extension-express-tools@2.1.0")},(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var s=r(3),a=r.n(s),n=r(4),i=r.n(n),_=r(5),o=r.n(_),d=r(6),l=r.n(d),u=r(7),c=r.n(u),p=r(8),E=r(1),h=r(9),m=r(39),O=r(40),f=r(42),b=r(13),g=r.n(b),A=r(19),P=r.n(A),M=r(12);function D(e,t){g().setProvider(e);const r=t?new p.WebtaskStorageContext(t,{force:1}):new p.FileStorageContext(a().join(__dirname,"./data.json"),{mergeWrites:!0}),s=new(o());s.use(((e,t,r)=>{e.webtaskContext&&g().setProvider(p.configProvider.fromWebtaskContext(e.webtaskContext)),r()})),s.use(i()(":method :url :status :response-time ms - :res[content-length]",{stream:P().stream})),s.use(l().json()),s.use(l().urlencoded({extended:!1})),s.use(E.routes.dashboardAdmins({secret:g()("EXTENSION_SECRET"),audience:"urn:delegated-admin",rta:g()("AUTH0_RTA").replace("https://",""),domain:g()("AUTH0_DOMAIN"),baseUrl:g()("PUBLIC_WT_URL"),webtaskUrl:g()("PUBLIC_WT_URL"),clientName:"Delegated Administration",noAccessToken:!0,urlPrefix:"/admins",sessionStorageKey:"delegated-admin:apiToken",scopes:"read:clients delete:clients read:connections read:connections_options read:users update:users delete:users create:users read:logs read:device_credentials update:device_credentials delete:device_credentials delete:guardian_enrollments"})),s.use("/api",(0,h.default)(r)),s.use("/app",o().static(a().join(__dirname,"../dist"))),s.use("/meta",(0,O.default)()),s.use("/.extensions",(0,m.default)()),s.get("*",c()(),(0,f.default)());return s.use((0,M.errorHandler)((e=>P().log("error",e)))),s}},e=>{e.exports=require("path")},e=>{e.exports=require("morgan@1.10.0")},e=>{e.exports=require("express@4.18.2")},e=>{e.exports=require("body-parser@1.20.2")},e=>{e.exports=require("cookie-parser@1.4.6")},e=>{e.exports=require("auth0-extension-tools@1.5.2")},(e,t,r)=>{r.r(t),r.d(t,{default:()=>M});var s=r(5),a=r(10),n=r.n(a),i=r(11),_=r.n(i),o=r(1),d=r(8),l=r.n(d),u=r(12),c=r(13),p=r.n(c),E=r(14),h=r(23),m=r(24),O=r(25),f=r(27),b=r(28),g=r(29),A=r(30),P=r(31);const M=e=>{const t=new E.default(e),r=async function(e,t,r){try{const t={domain:p()("AUTH0_DOMAIN"),clientId:p()("AUTH0_CLIENT_ID"),clientSecret:p()("AUTH0_CLIENT_SECRET")},s=e.user&&e.user.access_token&&e.user.access_token.length?{domain:t.domain,accessToken:e.user.access_token,headers:t.headers}:t;return e.auth0=await l().managementApi.getClient(s),r(),null}catch(e){r(e)}},a=(0,s.Router)(),i=e=>n().get(e,"headers.authorization","").split(" ")[1],d=(e,t)=>{if(global.daeUser=global.daeUser||{},global.daeUser[t.sub]=global.daeUser[t.sub]||{exp:0,token:""},n().isFunction(global.daeUser[t.sub].then))return global.daeUser[t.sub];if(global.daeUser[t.sub].exp>_()().unix()&&e&&global.daeUser[t.sub].token===e)return n().assign(t,global.daeUser[t.sub]),Promise.resolve(t);e||console.error("no token found");const r=l().managementApi.getClient({domain:p()("AUTH0_DOMAIN"),clientId:p()("AUTH0_CLIENT_ID"),clientSecret:p()("AUTH0_CLIENT_SECRET")}).then((r=>r.users.get({id:t.sub}).then((r=>(n().assign(t,r),t.token=e,global.daeUser[t.sub]=t,t)))));return global.daeUser[t.sub]=r,global.daeUser[t.sub]};return a.use(o.middlewares.authenticateUsers.optional({domain:p()("AUTH0_CUSTOM_DOMAIN")||p()("AUTH0_DOMAIN"),audience:p()("EXTENSION_CLIENT_ID"),credentialsRequired:!1,onLoginSuccess:(e,t,r)=>{const s=e;return d(i(e),e.user).then((t=>(s.user=t,s.user.scope=(0,h.default)(e.user),r()))).catch(r)}})),a.use(o.middlewares.authenticateAdmins.optional({credentialsRequired:!1,secret:p()("EXTENSION_SECRET"),audience:"urn:delegated-admin",baseUrl:p()("PUBLIC_WT_URL"),onLoginSuccess:(e,t,r)=>{const s=e;return d(i(e),e.user).then((e=>(s.user=e,s.user.scope=[m.AUDITOR_PERMISSION,m.USER_PERMISSION,m.OPERATOR_PERMISSION,m.ADMIN_PERMISSION],r()))).catch(r)}})),a.use(((e,t,r)=>{t.setHeader("Cache-control","no-cache, no-store"),t.setHeader("Pragma","no-cache"),t.setHeader("Expires","0"),r()})),a.use(((e,t,r)=>{const s="get"===e.method.toLowerCase()?m.AUDITOR_PERMISSION:m.USER_PERMISSION;return(0,u.requireScope)(s)(e,t,r)})),a.use("/applications",r,(0,O.default)()),a.use("/connections",r,(0,f.default)(t)),a.use("/scripts",(0,u.requireScope)(m.ADMIN_PERMISSION),(0,b.default)(e,t)),a.use("/users",r,(0,P.default)(e,t)),a.use("/logs",r,(0,A.default)(t)),a.use("/me",(0,g.default)(t)),a.get("/settings",((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((e=>r.json({settings:e||{}}))).catch(s)})),a}},e=>{e.exports=require("lodash@4.17.21")},e=>{e.exports=require("moment@2.29.4")},()=>{throw new Error("Module build failed (from ./node_modules/babel-loader/lib/index.js):\nSyntaxError: /Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/server/lib/middlewares/index.js: Support for the experimental syntax 'exportDefaultFrom' isn't currently enabled (1:8):\n\n[0m[31m[1m>[22m[39m[90m 1 |[39m [36mexport[39m verifyUserAccess [36mfrom[39m [32m'./verifyUserAccess'[39m[33m;[39m\n [90m   |[39m        [31m[1m^[22m[39m\n [90m 2 |[39m [36mexport[39m requireScope [36mfrom[39m [32m'./requireScope'[39m[33m;[39m\n [90m 3 |[39m [36mexport[39m errorHandler [36mfrom[39m [32m'./errorHandler'[39m[33m;[39m\n [90m 4 |[39m[0m\n\nAdd @babel/plugin-proposal-export-default-from (https://github.com/babel/babel/tree/main/packages/babel-plugin-proposal-export-default-from) to the 'plugins' section of your Babel config to enable transformation.\nIf you want to leave it as-is, add @babel/plugin-syntax-export-default-from (https://github.com/babel/babel/tree/main/packages/babel-plugin-syntax-export-default-from) to the 'plugins' section to enable parsing.\n\nIf you already added the plugin for this syntax to your config, it's possible that your config isn't being loaded.\nYou can re-run Babel with the BABEL_SHOW_CONFIG_FOR environment variable to show the loaded configuration:\n\tnpx cross-env BABEL_SHOW_CONFIG_FOR=/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/server/lib/middlewares/index.js <your build command>\nSee https://babeljs.io/docs/configuration#print-effective-configs for more info.\n\n    at constructor (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:360:19)\n    at Parser.raise (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:3327:19)\n    at Parser.expectPlugin (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:3355:16)\n    at Parser.maybeParseExportDefaultSpecifier (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:13472:12)\n    at Parser.parseExport (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:13411:29)\n    at Parser.parseStatementContent (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:12509:27)\n    at Parser.parseStatementLike (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:12396:17)\n    at Parser.parseModuleItem (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:12373:17)\n    at Parser.parseBlockOrModuleBlockBody (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:12950:36)\n    at Parser.parseBlockBody (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:12943:10)\n    at Parser.parseProgram (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:12270:10)\n    at Parser.parseTopLevel (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:12260:25)\n    at Parser.parse (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:14110:10)\n    at parse (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/parser/lib/index.js:14123:26)\n    at parser (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/core/lib/parser/index.js:41:34)\n    at parser.next (<anonymous>)\n    at normalizeFile (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/core/lib/transformation/normalize-file.js:64:37)\n    at normalizeFile.next (<anonymous>)\n    at run (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/core/lib/transformation/index.js:22:50)\n    at run.next (<anonymous>)\n    at transform (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/@babel/core/lib/transform.js:22:33)\n    at transform.next (<anonymous>)\n    at step (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/gensync/index.js:261:32)\n    at /Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/gensync/index.js:273:13\n    at async.call.result.err.err (/Users/nikolai.kavtur/workspace/auth0/auth0-delegated-administration-extension/node_modules/gensync/index.js:223:11)")},(e,t,r)=>{const s=r(8).config(),a=function(e){return"AUTH0_CUSTOM_DOMAIN"===e?s("AUTH0_CUSTOM_DOMAIN")||s("AUTH0_DOMAIN"):"IS_APPLIANCE"===e?s("AUTH0_RTA")&&"auth0.auth0.com"!==s("AUTH0_RTA").replace("https://",""):s(e)};a.getValue=function(e){return s(e)},a.setValue=function(e,t){return s.setValue(e,t)},a.setProvider=function(e){return s.setProvider(e)},e.exports=a},(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var s=r(15),a=r.n(s),n=r(16),i=r.n(n),_=r(18),o=r.n(_),d=r(8),l=r(19),u=r.n(l),c=r(21);class p{constructor(e,t=1e4){if(null==e)throw new d.ArgumentError("Must provide a storage object.");this.log=u().debug.bind(u()),this.cache={},this.storage=e,this.getCached=a().promisify(o()({load:(e,t)=>{this.get(e).then((e=>(t(null,e),null))).catch(t)},hash:e=>e,max:100,maxAge:t}))}get(e){return this.storage.read().then((t=>t&&t.scripts?t.scripts[e]:null))}save(e,t){return this.storage.read().then((r=>(r.scripts||(r.scripts={}),r.scripts[e]=t,r))).then((e=>this.storage.write(e)))}readCustomData(){return this.storage.read().then((e=>e.customData||{}))}writeCustomData(e){return this.storage.read().then((t=>(t.customData=e,t))).then((e=>this.storage.write(e)))}createContext(e){return{log:this.log,global:this.cache,read:this.readCustomData.bind(this),write:this.writeCustomData.bind(this),...e}}dynamicRequire(e){try{return require(e)}catch(e){}return r(22)(e)}execute(e,t){return this.getCached(e).then((r=>r?(u().debug(`Executing Delegated Admin hook: ${e}`),new(a())(((s,a)=>{try{i()(r,{require:this.dynamicRequire})(this.createContext(t),((t,r)=>{t?(u().error(`Failed to execute Delegated Admin hook (${e}): "${t}"`),a((0,c.default)(t,e))):s(r)}))}catch(t){u().error(`Failed to compile Delegated Admin hook (${e}): "${t}"`),a((0,c.default)(t,e))}}))):null))}}},e=>{e.exports=require("bluebird@3.7.2")},(e,t,r)=>{var s=r(17);e.exports=function(e,t,r){var a={},n="SAFE_EVAL_"+Math.floor(1e6*Math.random());a[n]={};return e="\n    (function(){\n      Function = undefined;\n      const keys = Object.getOwnPropertyNames(this).concat(['constructor']);\n      keys.forEach((key) => {\n        const item = this[key];\n        if(!item || typeof item.constructor !== 'function') return;\n        this[key].constructor = undefined;\n      });\n    })();\n  "+n+"="+e,t&&Object.keys(t).forEach((function(e){a[e]=t[e]})),s.runInNewContext(e,a,r),a[n]}},e=>{e.exports=require("vm")},e=>{e.exports=require("lru-memoizer@1.10.0")},(e,t,r)=>{const s=r(20),a=s.createLogger({levels:s.config.syslog.levels,transports:[new s.transports.Console({level:"debug",handleExceptions:!0,format:s.format.combine(s.format.timestamp(),s.format.printf((e=>`${e.timestamp} - ${e.level}: ${e.message}`)))})],exitOnError:!1});e.exports=a,e.exports.stream={write:e=>{a.log("info",e.replace(/\n$/,""))}}},e=>{e.exports=require("winston@3.10.0")},(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var s=r(8);const a=(e,t)=>{const r=new s.ValidationError(e.message||"");let a=`${t}-script error`;return e.stack&&(a=e.stack.replace(/SAFE_EVAL_\d+/,`${t}-script error`).replace("evalmachine.<anonymous>","line")),r.stack=a.split("\n").slice(0,2).join(" "),r}},e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=22,e.exports=t},(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var s=r(10),a=r.n(s),n=r(24);const i=(e,t)=>{const r=a().find(e,((e,t)=>a().startsWith(t,"https:")&&a().endsWith(t,"auth0-delegated-admin"))),s=[e[t],e.app_metadata&&e.app_metadata[t],e.app_metadata&&e.app_metadata.authorization&&e.app_metadata.authorization[t],r&&r[t]];return a()(s).flatten().compact().uniq().value()},_=e=>{let t=-1;if(!e)return t;const r=Array.isArray(e)?e:e.replace(", ",",","g").split(",");return r.indexOf(n.AUDITOR_ROLE_NAME)>=0&&(t=n.AUDITOR_ACCESS_LEVEL),r.indexOf(n.USER_ROLE_NAME)>=0&&(t=n.USER_ACCESS_LEVEL),r.indexOf(n.OPERATOR_ROLE_NAME)>=0&&(t=n.OPERATOR_ACCESS_LEVEL),r.indexOf(n.ADMIN_ROLE_NAME)>=0&&(t=n.ADMIN_ACCESS_LEVEL),t};function o(e){const t=i(e,"roles"),r=i(e,"permissions"),s=_(t);return s>=n.AUDITOR_ACCESS_LEVEL&&r.indexOf(n.AUDITOR_PERMISSION)<0&&r.push(n.AUDITOR_PERMISSION),s>=n.USER_ACCESS_LEVEL&&r.indexOf(n.USER_PERMISSION)<0&&r.push(n.USER_PERMISSION),s>=n.OPERATOR_ACCESS_LEVEL&&r.indexOf(n.OPERATOR_PERMISSION)<0&&r.push(n.OPERATOR_PERMISSION),s===n.ADMIN_ACCESS_LEVEL&&r.indexOf(n.ADMIN_PERMISSION)<0&&r.push(n.ADMIN_PERMISSION),r}},(e,t,r)=>{r.r(t),r.d(t,{ADMIN_ACCESS_LEVEL:()=>i,ADMIN_PERMISSION:()=>E,ADMIN_ROLE_NAME:()=>l,AUDITOR_ACCESS_LEVEL:()=>s,AUDITOR_PERMISSION:()=>u,AUDITOR_ROLE_NAME:()=>_,OPERATOR_ACCESS_LEVEL:()=>n,OPERATOR_PERMISSION:()=>p,OPERATOR_ROLE_NAME:()=>d,USER_ACCESS_LEVEL:()=>a,USER_PERMISSION:()=>c,USER_ROLE_NAME:()=>o,VALID_SCRIPTS:()=>h});const s=0,a=1,n=2,i=3,_="Delegated Admin - Auditor",o="Delegated Admin - User",d="Delegated Admin - Operator",l="Delegated Admin - Administrator",u="read:users",c="manage:users",p="read:logs",E="manage:config",h=["access","filter","create","memberships","settings"]},(e,t,r)=>{r.r(t),r.d(t,{default:()=>_});var s=r(10),a=r.n(s),n=r(5),i=r(26);const _=()=>{const e=(0,n.Router)();return e.get("/",((e,t,r)=>{(0,i.default)(e.auth0,"clients",{is_global:!1,fields:"client_id,name,app_type"}).then((e=>a().chain(e).filter((e=>"spa"===e.app_type||"native"===e.app_type||"regular_web"===e.app_type)).map((({client_id:e,name:t})=>({client_id:e,name:t}))).sortBy((e=>e.name.toLowerCase())).value())).then((e=>t.json(e))).catch(r)})),e}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var s=r(15),a=r.n(s),n=r(8);function i(e,t,r={},s={}){const i=s.perPage||50,_=s.concurrency||5,o=s.limit||null;if(null==e)throw new n.ArgumentError("Must provide a auth0 client object.");if(!t&&!e[t])throw new n.ArgumentError("Must provide a valid entity for auth0 client.");const d={...r,per_page:i},l=[];let u=0,c=0;const p=r=>e[t].getAll({...d,page:r}).then((e=>(e.forEach((e=>l.push(e))),null)));return e[t].getAll({...d,include_totals:!0,page:0}).then((e=>(u=e.total||0,c=Math.ceil(u/i),o&&u>o?(c=1,null):((e[t]||e||[]).forEach((e=>l.push(e))),null)))).then((()=>{if(o&&u>o)return l;if(0===u||l.length>=u)return l;const e=[];for(let t=1;t<=c;t++)e.push(t);return a().map(e,p,{concurrency:_})})).then((()=>l))}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>_});var s=r(10),a=r.n(s),n=r(5),i=r(26);const _=e=>{const t=(0,n.Router)();return t.get("/",((t,r,s)=>{(0,i.default)(t.auth0,"connections",{strategy:"auth0",fields:"id,name,strategy,options"},{limit:2e4,perPage:100}).then((r=>{global.connections=r.map((e=>({name:e.name,id:e.id})));const s={request:{user:t.user},locale:t.headers["dae-locale"]};return e.execute("settings",s).then((e=>{let t=a().chain(r).sortBy((e=>e.name.toLowerCase())).value();return e&&e.connections&&Array.isArray(e.connections)&&e.connections.length&&(t=t.filter((t=>e.connections.indexOf(t.name)>=0))),t}))})).then((e=>e.map((e=>({id:e.id,name:e.name,strategy:e.strategy,options:e.options?{requires_username:e.options.requires_username}:null}))))).then((e=>r.json(e))).catch(s)})),t}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var s=r(5),a=r(8),n=r(24);const i=(e,t)=>{const r=(0,s.Router)();return r.get("/:name",((e,r,s)=>n.VALID_SCRIPTS.indexOf(e.params.name)<0?s(new a.ValidationError(`Invalid script name: ${e.params.name}`)):t.get(e.params.name).then((e=>r.json({script:e}))).catch(s))),r.post("/:name",((e,r,s)=>n.VALID_SCRIPTS.indexOf(e.params.name)<0?s(new a.ValidationError(`Invalid script name: ${e.params.name}`)):t.save(e.params.name,e.body.script).then((()=>r.status(200).send())).catch(s))),r}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var s=r(5),a=r.n(s),n=r(19),i=r.n(n),_=r(24);const o=e=>{const t=a().Router();return t.get("/",((t,r)=>{let s=0;t.user.scope.indexOf(_.ADMIN_PERMISSION)>=0?s=3:t.user.scope.indexOf(_.OPERATOR_PERMISSION)>=0?s=2:t.user.scope.indexOf(_.USER_PERMISSION)>=0&&(s=1);const a={createMemberships:!1,memberships:[],role:s},n={request:{user:t.user},payload:{user:t.user}};e.execute("memberships",n).then((e=>(e&&Array.isArray(e)?a.memberships=e:e&&(a.createMemberships=e.createMemberships||!1,a.memberships=e.memberships||[]),r.json(a)))).catch((e=>{i().error(e.message),r.json(a)}))})),t}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var s=r(15),a=r.n(s),n=r(5),i=r(8),_=r(12),o=r(24);const d=e=>{const t=(0,n.Router)();return t.get("/",(0,_.requireScope)(o.OPERATOR_PERMISSION),((e,t,r)=>{e.auth0.logs.getAll({q:"NOT type: sapi AND NOT type:fapi",sort:"date:-1",per_page:20,page:e.query.page||0,fields:"type,date,client_name,user_name,description,connection"}).then((e=>t.json(e))).catch(r)})),t.get("/:id",((t,r,s)=>{t.auth0.logs.get({id:t.params.id}).then((r=>!r||"fapi"!==r.type&&"sapi"!==r.type?t.user.scope.indexOf(o.OPERATOR_PERMISSION)>=0?r:t.auth0.users.get({id:r.user_id}).then((s=>{if(!s)throw new i.NotFoundError(`User not found: ${t.params.id}`);const a={request:{user:t.user},payload:{user:s}};return e.execute("access",a).then((()=>r))})):a().reject(new Error("Invalid log record.")))).then((e=>r.json({log:e}))).catch(s)})),t}},(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__),auth0__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(32),auth0__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(auth0__WEBPACK_IMPORTED_MODULE_1__),request__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(33),request__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(request__WEBPACK_IMPORTED_MODULE_2__),bluebird__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(15),bluebird__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(bluebird__WEBPACK_IMPORTED_MODULE_3__),express__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5),express__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_4__),auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8),auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__),_lib_config__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(13),_lib_config__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_lib_config__WEBPACK_IMPORTED_MODULE_6__),_lib_logger__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(19),_lib_logger__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(_lib_logger__WEBPACK_IMPORTED_MODULE_7__),_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(12),_lib_middlewares__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__),_lib_removeGuardian__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(34),_lib_userBlocks__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(36),_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(37),_lib_getConnectionIdByName__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(38);const isValidField=(e,t,r)=>t&&lodash__WEBPACK_IMPORTED_MODULE_0___default().includes(t,r.property)||!t&&!1!==r[e],checkCustomFieldValidation=(req,context,isEditRequest,onlyTheseFields)=>{if(!context.userFields)return context.payload;const requiredErrorText=req.query&&req.query.requiredErrorText||"required",type=isEditRequest?"edit":"create",ignoredFields=lodash__WEBPACK_IMPORTED_MODULE_0___default().map(lodash__WEBPACK_IMPORTED_MODULE_0___default().filter(context.userFields,(e=>!isValidField(type,onlyTheseFields,e))),"property"),fieldsToValidate=lodash__WEBPACK_IMPORTED_MODULE_0___default().filter(context.userFields,(e=>!lodash__WEBPACK_IMPORTED_MODULE_0___default().includes(ignoredFields,e.property)&&lodash__WEBPACK_IMPORTED_MODULE_0___default().isObject(e[type])&&(e[type].required||e[type].validationFunction))),errorList={};if(fieldsToValidate.forEach((field=>{const value=lodash__WEBPACK_IMPORTED_MODULE_0___default().get(context.payload,field.property),errorKey=field.label||field.property;if(value&&0!==value.length){if(field[type].validationFunction)try{const validationFunction=eval(`(${field[type].validationFunction})`);if(lodash__WEBPACK_IMPORTED_MODULE_0___default().isFunction(validationFunction)){const e=validationFunction(value,context.payload);if(e)return void(errorList[errorKey]=e)}else _lib_logger__WEBPACK_IMPORTED_MODULE_7___default().warn(`warning: skipping invalid validation function: ${field[type].validationFunction}, because: it is not a function`)}catch(e){_lib_logger__WEBPACK_IMPORTED_MODULE_7___default().warn(`warning: skipping invalid validation function: ${field[type].validationFunction}, because: `,e.message)}if(field[type].options){const e=lodash__WEBPACK_IMPORTED_MODULE_0___default().isObject(value)?value.value:value,t=lodash__WEBPACK_IMPORTED_MODULE_0___default().map(field[type].options,(e=>lodash__WEBPACK_IMPORTED_MODULE_0___default().isObject(e)?e.value:e));if(t.indexOf(e)<0)return void(errorList[errorKey]=`${e} is not an allowed option`)}}else field[type].required&&(errorList[errorKey]=[requiredErrorText||"required"])})),Object.keys(errorList).length>0)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError(lodash__WEBPACK_IMPORTED_MODULE_0___default().map(errorList,((e,t)=>`${t}: ${e}`)).join("\n"));if(onlyTheseFields){const e=lodash__WEBPACK_IMPORTED_MODULE_0___default().cloneDeep(context.payload);context.payload={},onlyTheseFields.forEach((t=>{lodash__WEBPACK_IMPORTED_MODULE_0___default().set(context.payload,t,lodash__WEBPACK_IMPORTED_MODULE_0___default().get(e,t))}))}return lodash__WEBPACK_IMPORTED_MODULE_0___default().omit(context.payload,ignoredFields)},executeWriteHook=(e,t,r,s)=>{const a=e.targetUser,n={method:"update",request:{user:e.user,originalUser:a},payload:e.body,userFields:r};try{n.payload=checkCustomFieldValidation(e,n,!0,s)}catch(e){return bluebird__WEBPACK_IMPORTED_MODULE_3___default().reject(e)}return t.execute("create",n)},__WEBPACK_DEFAULT_EXPORT__=(e,t)=>{const r=(0,express__WEBPACK_IMPORTED_MODULE_4__.Router)();return r.post("/",((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((a=>{const n=(a=a||{}).userFields,i={method:"create",request:{user:e.user},payload:e.body,defaultPayload:{email:e.body.email,username:e.body.username,password:e.body.password,connection:e.body.connection,app_metadata:e.body.memberships&&e.body.memberships.length&&{memberships:e.body.memberships}||{}},userFields:n};if(!1===(void 0===a.canCreateUser||a.canCreateUser))return s(new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.UnauthorizedError("Create user is forbidden"));if(!lodash__WEBPACK_IMPORTED_MODULE_0___default().find(n,{property:"repeatPassword"})&&e.body.repeatPassword!==e.body.password)return s(new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The passwords do not match."));try{i.payload=checkCustomFieldValidation(e,i)}catch(e){return s(e)}return delete i.payload.repeatPassword,t.execute("create",i).then((e=>{if(!(e=e||i.defaultPayload).email||0===e.email.length)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The email address is required.");return e})).then((t=>e.auth0.users.create(t))).then((()=>r.status(201).send())).catch(s)}))})),r.get("/",((e,r,s)=>{const a={request:{user:e.user},payload:{search:e.query.search,filterBy:e.query.filterBy}},n=_lib_config__WEBPACK_IMPORTED_MODULE_6___default()("USER_SEARCH_ENGINE")||"v3",i="v2"===n?'"':"";let _=e.query.search;e.query.filterBy&&e.query.filterBy.length>0&&(_=`${e.query.filterBy}:${i}${e.query.search}${i}`);const o=e.query.sortProperty&&e.query.sortOrder?`${e.query.sortProperty}:${e.query.sortOrder}`:"last_login:-1";t.execute("filter",a).then((t=>{const r=t&&void 0!==t.query?t.query:t,s={sort:o,q:_&&r?`(${_}) AND ${r}`:_||r,per_page:e.query.per_page||10,page:e.query.page||0,include_totals:!0,fields:"user_id,username,name,email,identities,picture,last_login,logins_count,multifactor,blocked,app_metadata,user_metadata",search_engine:n};return e.auth0.users.getAll(s)})).then((r=>bluebird__WEBPACK_IMPORTED_MODULE_3___default().map(r.users,((s,a)=>t.execute("access",{request:{user:e.user},payload:{user:s,action:"read:user"}}).then((e=>{r.users[a]=e||s})))).then((()=>r)))).then((e=>r.json(e))).catch((e=>s(e)))})),r.get("/:id",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("read:user",t),((e,r,s)=>{const a=e.targetUser,n={request:{user:e.user},payload:{user:a}};return t.execute("memberships",n).then((e=>e&&Array.isArray(e)?{user:a,memberships:e}:e&&e.memberships?{user:a,memberships:e.memberships}:{user:a,memberships:[]})).then((t=>{if(!t.user.identities)return t.connection={},t;const r=t.user.identities.filter((e=>"auth0"===e.provider)),s=r[0]&&r[0].connection;return s?(t.user.connection=s,(0,_lib_getConnectionIdByName__WEBPACK_IMPORTED_MODULE_12__.default)(e.auth0,s).then((t=>t?e.auth0.connections.get({id:t,fields:"enabled_clients"}):{})).then((e=>(t.connection={enabled_clients:e.enabled_clients},t)))):(t.connection={},t)})).then((t=>(0,_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__.default)(e).then((r=>(0,_lib_userBlocks__WEBPACK_IMPORTED_MODULE_10__.requestUserBlocks)(r,e.params.id).then((e=>(e&&(t.user.blocked_for=e),r))))).then((s=>(0,_lib_removeGuardian__WEBPACK_IMPORTED_MODULE_9__.requestGuardianEnrollments)(s,e.params.id).then((e=>(!t.user.multifactor||e&&e.length?!t.user.multifactor&&e&&(t.user.multifactor=["guardian"]):(t.user.multifactor=t.user.multifactor.filter((e=>"guardian"!==e)),t.user.multifactor=t.user.multifactor.length?t.user.multifactor:null),r.json(t)))))))).catch((e=>{_lib_logger__WEBPACK_IMPORTED_MODULE_7___default().error("Failed to get user because: ",e),s(e)}))})),r.delete("/:id",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("delete:user",t),((e,t,r)=>e.user.sub===e.params.id?r(new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("You cannot delete yourself.")):e.auth0.users.delete({id:e.params.id}).then((()=>t.sendStatus(204))).catch(r))),r.patch("/:id",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("change:profile",t),((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((r=>{const s=["username","email","password","repeatPassword","connection"],a=lodash__WEBPACK_IMPORTED_MODULE_0___default().map(lodash__WEBPACK_IMPORTED_MODULE_0___default().filter(r.userFields,(e=>e.edit&&!lodash__WEBPACK_IMPORTED_MODULE_0___default().includes(s,e.property))),"property");return executeWriteHook(e,t,r.userFields,a)})).then((t=>e.auth0.users.update({id:e.params.id},t))).then((()=>r.status(204).send())).catch(s)})),r.post("/:id/password-reset",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("reset:password",t),((e,t,r)=>{const s=new(auth0__WEBPACK_IMPORTED_MODULE_1___default().AuthenticationClient)({domain:_lib_config__WEBPACK_IMPORTED_MODULE_6___default()("AUTH0_DOMAIN"),clientId:_lib_config__WEBPACK_IMPORTED_MODULE_6___default()("AUTH0_CLIENT_ID")}),a={email:e.targetUser.email,connection:e.body.connection,client_id:e.body.clientId};return s.requestChangePasswordEmail(a).then((()=>t.sendStatus(204))).catch(r)})),r.put("/:id/change-password",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("change:password",t),((e,r,s)=>{if(e.body.password!==e.body.repeatPassword)return s(new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ArgumentError("Passwords don't match"));const a={request:{user:e.user},locale:e.headers["dae-locale"]};return t.execute("settings",a).then((a=>a&&a.userFields?executeWriteHook(e,t,a.userFields,["password","repeatPassword"]).then((t=>{if(!t.password)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The password is required.");t=lodash__WEBPACK_IMPORTED_MODULE_0___default().pick(t,["password","connection","verify_password","app_metadata"]);const a=lodash__WEBPACK_IMPORTED_MODULE_0___default().defaults(t,{connection:e.body.connection,verify_password:!1});return e.auth0.users.update({id:e.params.id},a).then((()=>r.sendStatus(204))).catch(s)})):e.auth0.users.update({id:e.params.id},{password:e.body.password,connection:e.body.connection,verify_password:!1}).then((()=>r.sendStatus(204))).catch(s))).catch(s)})),r.put("/:id/change-username",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("change:username",t),((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((a=>{a&&a.userFields?executeWriteHook(e,t,a.userFields,["username"]).then((t=>{if(!t.username)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The username is required.");return e.auth0.users.update({id:e.params.id},t)})).then((()=>r.status(204).send())).catch(s):e.auth0.users.update({id:e.params.id},{username:e.body.username}).then((()=>r.sendStatus(204))).catch(s)})).catch(s)})),r.put("/:id/change-email",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("change:email",t),((e,r,s)=>{const a={request:{user:e.user},locale:e.headers["dae-locale"]};t.execute("settings",a).then((a=>{a&&a.userFields?executeWriteHook(e,t,a.userFields,["email"]).then((t=>{if(!t.email)throw new auth0_extension_tools__WEBPACK_IMPORTED_MODULE_5__.ValidationError("The email is required.");return e.auth0.users.update({id:e.params.id},t)})).then((()=>r.status(204).send())).catch(s):e.auth0.users.update({id:e.params.id},{email:e.body.email}).then((()=>r.sendStatus(204))).catch(s)})).catch(s)})),r.get("/:id/devices",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("read:devices",t),((e,t,r)=>{e.auth0.deviceCredentials.getAll({user_id:e.params.id}).then((e=>t.json({devices:e}))).catch(r)})),r.get("/:id/logs",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("read:logs",t),((e,t,r)=>{(0,_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__.default)(e).then((s=>{const a={uri:`https://${_lib_config__WEBPACK_IMPORTED_MODULE_6___default()("AUTH0_DOMAIN")}/api/v2/users/${encodeURIComponent(e.params.id)}/logs`,headers:{authorization:`Bearer ${s}`},json:!0};return request__WEBPACK_IMPORTED_MODULE_2___default().get(a,((e,s,a)=>e?r(e):s.statusCode<200||s.statusCode>=300?(_lib_logger__WEBPACK_IMPORTED_MODULE_7___default().error("Log response failed: ",s.headers),r(new Error(a&&(a.error||a.message||a.code)||`Request Error: ${s.statusCode}`))):t.json(a)))})).catch(r)})),r.delete("/:id/multifactor/:provider",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("remove:multifactor-provider",t),((e,t,r)=>{const s=e.params.provider,a=e.params.id;"duo"===s||"google-authenticator"===s?e.auth0.users.deleteMultifactorProvider({id:a,provider:s}).then((()=>t.sendStatus(204))).catch(r):(0,_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__.default)(e).then((e=>(0,_lib_removeGuardian__WEBPACK_IMPORTED_MODULE_9__.removeGuardian)(e,a))).then((()=>t.sendStatus(204))).catch(r)})),r.put("/:id/block",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("block:user",t),((e,t,r)=>{e.auth0.users.update({id:e.params.id},{blocked:!0}).then((()=>t.sendStatus(204))).catch(r)})),r.put("/:id/unblock",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("unblock:user",t),((e,t,r)=>{e.auth0.users.update({id:e.params.id},{blocked:!1}).then((()=>t.sendStatus(204))).catch(r)})),r.delete("/:id/blocks",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("unblock:user",t),((e,t,r)=>{(0,_lib_getApiToken__WEBPACK_IMPORTED_MODULE_11__.default)(e).then((t=>(0,_lib_userBlocks__WEBPACK_IMPORTED_MODULE_10__.removeUserBlocks)(t,e.params.id))).then((()=>t.sendStatus(204))).catch(r)})),r.post("/:id/send-verification-email",(0,_lib_middlewares__WEBPACK_IMPORTED_MODULE_8__.verifyUserAccess)("send:verification-email",t),((e,t,r)=>{const s={user_id:e.params.id};e.auth0.jobs.verifyEmail(s).then((()=>t.status(204).send())).catch(r)})),r}},e=>{e.exports=require("auth0@3.5.0")},e=>{e.exports=require("request@2.88.2")},(e,t,r)=>{r.r(t),r.d(t,{removeGuardian:()=>l,requestGuardianEnrollments:()=>d});var s=r(15),a=r.n(s),n=r(35),i=r.n(n),_=r(13),o=r.n(_);const d=(e,t)=>new(a())(((r,s)=>{i().get(`https://${o()("AUTH0_DOMAIN")}/api/v2/users/${t}/enrollments`).set("Authorization",`Bearer ${e}`).set("Content-Type","application/json").end(((e,t)=>{if(e)return s(e);const a=t&&t.body&&t.body[0]?t.body[0].id:null;return r(a)}))})),l=(e,t)=>d(e,t).then((t=>((e,t)=>new(a())(((r,s)=>t?i().del(`https://${o()("AUTH0_DOMAIN")}/api/v2/guardian/enrollments/${t}`).set("Authorization",`Bearer ${e}`).set("Content-Type","application/json").end((e=>e?s(e):r())):r(null))))(e,t)))},e=>{e.exports=require("superagent@8.0.9")},(e,t,r)=>{r.r(t),r.d(t,{removeUserBlocks:()=>l,requestUserBlocks:()=>d});var s=r(15),a=r.n(s),n=r(35),i=r.n(n),_=r(13),o=r.n(_);const d=(e,t)=>new(a())(((r,s)=>{i().get(`https://${o()("AUTH0_DOMAIN")}/api/v2/user-blocks/${t}`).set("Authorization",`Bearer ${e}`).set("Content-Type","application/json").end(((e,t)=>{if(e)return s(e);const a=t&&t.body&&t.body.blocked_for?t.body.blocked_for:null;return r(a)}))})),l=(e,t)=>new(a())(((r,s)=>{i().del(`https://${o()("AUTH0_DOMAIN")}/api/v2/user-blocks/${t}`).set("Authorization",`Bearer ${e}`).set("Content-Type","application/json").end(((e,t)=>e?s(e):r(t)))}))},(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var s=r(15),a=r.n(s),n=r(8),i=r(13),_=r.n(i);const o=e=>e&&e.user&&e.user.access_token?new(a())((t=>t(e.user.access_token))):n.managementApi.getAccessTokenCached(_()("AUTH0_DOMAIN"),_()("AUTH0_CLIENT_ID"),_()("AUTH0_CLIENT_SECRET"))},(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var s=r(15),a=r.n(s);function n(e,t){const r=Array.isArray(global.connections)&&global.connections.filter((e=>e.name===t))[0];return r?a().resolve(r.id):e.connections.getAll({name:t,fields:"id"}).then((e=>e&&e[0]&&e[0].id))}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var s=r(5),a=r(1),n=r(13),i=r.n(n),_=r(19),o=r.n(_);const d=()=>{const e=a.middlewares.validateHookToken(i()("AUTH0_DOMAIN"),i()("WT_URL"),i()("EXTENSION_SECRET")),t=(0,s.Router)();return t.use("/on-uninstall",e("/.extensions/on-uninstall")),t.use(a.middlewares.managementApiClient({domain:i()("AUTH0_DOMAIN"),clientId:i()("AUTH0_CLIENT_ID"),clientSecret:i()("AUTH0_CLIENT_SECRET")})),t.delete("/on-uninstall",((e,t)=>{o().debug("Uninstall running..."),e.auth0.clients.delete({client_id:i()("AUTH0_CLIENT_ID")}).then((()=>{o().debug(`Deleted client: ${i()("AUTH0_CLIENT_ID")}`),t.sendStatus(204)})).catch((e=>{o().debug(`Error deleting client: ${i()("AUTH0_CLIENT_ID")}`),o().error(e),t.sendStatus(204)}))})),t}},(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var s=r(5),a=r.n(s),n=r(41);const i=()=>{const e=a().Router();return e.get("/",((e,t)=>{t.status(200).send(n)})),e}},e=>{e.exports=JSON.parse('{"title":"Delegated Administration Dashboard","name":"auth0-delegated-admin","version":"4.6.0","author":"auth0","useHashName":false,"description":"This extension allows non-dashboard administrators to manage (a subset of) users.","type":"application","category":"end_user","logoUrl":"https://cdn.auth0.com/extensions/auth0-delegated-admin/assets/logo.svg","initialUrlPath":"/","docsUrl":"https://auth0.com/docs/extensions/delegated-admin","repository":"https://github.com/auth0-extensions/auth0-delegated-administration-extension","keywords":["auth0","extension"],"auth0":{"createClient":true,"onUninstallPath":"/.extensions/on-uninstall","scopes":"read:clients delete:clients read:connections read:connections_options read:users update:users delete:users create:users read:logs read:device_credentials update:device_credentials delete:device_credentials delete:guardian_enrollments"},"secrets":{"EXTENSION_CLIENT_ID":{"description":"Client ID of the application you created in the Auth0 Dashboard","required":true},"TITLE":{"description":"Custom title for the dashboard","example":"Fabrikam User Management","required":false},"CUSTOM_CSS":{"description":"A CSS file containing custom styles for the extension","example":"https://cdn.fabrikam.com/static/extensions/theme/fabrikam.css","required":false},"FAVICON_PATH":{"description":"Path to custom favicon","example":"https://cdn.fabrikam.com/static/extensions/theme/favicon.png","required":false},"AUTH0_CUSTOM_DOMAIN":{"description":"Custom domain","example":"example.com","required":false},"USER_SEARCH_ENGINE":{"description":"User search engine. Cloud only supports V3","type":"select","default":"v3","allowMultiple":false,"options":[{"value":"v3","text":"v3"},{"value":"v2","text":"v2"}]},"FEDERATED_LOGOUT":{"description":"Also sign out from the IDP when users logout?","type":"select","allowMultiple":false,"options":[{"value":"false","text":"No"},{"value":"true","text":"Yes"}]}}}')},(e,t,r)=>{r.r(t),r.d(t,{default:()=>E});var s=r(43),a=r.n(s),n=r(44),i=r.n(n),_=r(3),o=r.n(_),d=r(1),l=r(19),u=r.n(l),c=r(13),p=r.n(c);const E=()=>{const e='\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n      <title><%= config.TITLE %></title>\n      <meta charset="UTF-8" />\n      <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n      <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n      <link rel="shortcut icon" href="<%= assets.favIcon %>" />\n      <meta name="viewport" content="width=device-width, initial-scale=1">\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styles/zocial.min.css" />\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/manage/v0.3.1672/css/index.min.css" />\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styleguide/4.6.13/index.min.css" />\n      <% if (assets.style) { %><link rel="stylesheet" type="text/css" href="/app/<%= assets.style %>" /><% } %>\n      <% if (assets.version) { %><link rel="stylesheet" type="text/css" href="<%= assets.cdnPath %>/auth0-delegated-admin.ui.<%= assets.version %>.css" /><% } %>\n      <% if (assets.customCss) { %><link rel="stylesheet" type="text/css" href="<%= assets.customCss %>" /><% } %>\n    </head>\n    <body>\n      <div id="app"></div>\n      <script src="https://cdn.auth0.com/js/auth0/9.8.2/auth0.min.js"><\/script>\n      <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.1672/js/bundle.js"><\/script>\n      <script type="text/javascript">window.config = <%- JSON.stringify(config) %>;<\/script>\n      <% if (assets.vendors) { %><script type="text/javascript" src="/app/<%= assets.vendors %>"><\/script><% } %>\n      <% if (assets.app) { %><script type="text/javascript" src="/app/<%= assets.app %>"><\/script><% } %>\n      <% if (assets.version) { %>\n      <script type="text/javascript" src="<%= assets.cdnPath %>/auth0-delegated-admin.ui.vendors.<%= assets.version %>.js"><\/script>\n      <script type="text/javascript" src="<%= assets.cdnPath %>/auth0-delegated-admin.ui.<%= assets.version %>.js"><\/script>\n      <% } %>\n    </body>\n    </html>\n    ';return(t,r,s)=>{if(0===t.url.indexOf("/api"))return s();const n=(e=>{const t=d.urlHelpers.getBasePath(e);u().log("info",e.originalUrl);const r=new URL(`https://${e.headers.host}${e.originalUrl}`).pathname.replace(t,"").split("/");return["api","login","logs","configuration","users"].indexOf(r[0])<0&&""!==r[0]?r[0]:e.cookies["dae-locale"]||"en"})(t),_=d.urlHelpers.getBasePath(t);if(0!==t.url.indexOf("/login")&&(r.cookie("dae-locale",n),0!==t.url.indexOf(`/${n}`)))return r.redirect(`${_}${n}${t.url||"/login"}`);const l={AUTH0_DOMAIN:p()("AUTH0_DOMAIN"),AUTH0_CUSTOM_DOMAIN:p()("AUTH0_CUSTOM_DOMAIN"),IS_APPLIANCE:p()("IS_APPLIANCE"),AUTH0_CLIENT_ID:p()("EXTENSION_CLIENT_ID"),EXTEND_URL:p()("EXTEND_URL"),BASE_URL:d.urlHelpers.getBaseUrl(t),BASE_PATH:`${_}${n}/`,TITLE:p()("TITLE"),FEDERATED_LOGOUT:"true"===p()("FEDERATED_LOGOUT"),AUTH0_MANAGE_URL:p()("AUTH0_MANAGE_URL")||"https://manage.auth0.com",LOCALE:n},c="4.6.0",E={WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"4.6.0"}.PR_NUMBER;if(c){const t=p()("FAVICON_PATH")||"https://cdn.auth0.com/styleguide/4.6.13/lib/logos/img/favicon.png",s=p()("CDN_PATH")||(E?`//s3.amazonaws.com/extensions-review/auth0-delegated-admin-pr-${E}/assets`:"//cdn.auth0.com/extensions/auth0-delegated-admin/assets");return r.send(i().render(e,{config:l,assets:{customCss:p()("CUSTOM_CSS"),version:c,cdnPath:s,favIcon:t}}))}return a().readFile(o().join(__dirname,"../../dist/manifest.json"),"utf8",((t,s)=>{const a={config:l,assets:{customCss:p()("CUSTOM_CSS"),app:"bundle.js"}};!t&&s&&(a.assets={customCss:p()("CUSTOM_CSS"),...JSON.parse(s)}),r.send(i().render(e,a))}))}}},e=>{e.exports=require("fs")},e=>{e.exports=require("ejs@3.1.9")}],__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__(0);module.exports=__webpack_exports__;